{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\DAPP-master-dup\\\\DAPP-master\\\\client\\\\src\\\\components\\\\AddDocument.js\";\nimport React, { useState, useContext } from 'react';\nimport Ipfs from './Ipfs';\nimport NodeRSA from 'node-rsa';\nimport Context from '../store/Context';\nimport { useNavigate } from 'react-router-dom';\nimport Axios from 'axios';\n\nconst AddDocument = () => {\n  const navigate = useNavigate();\n  const {\n    state,\n    dispatch\n  } = useContext(Context);\n  const [buffer, setBuffer] = useState();\n  const [publicKey, setPublicKey] = useState();\n  const [privateKey, setPrivateKey] = useState();\n  const [username, setUsername] = useState();\n  const [ext, setExt] = useState(\"\");\n\n  const handleFileChange = e => {\n    const file = e.target.files[0]; // console.log(file);\n\n    setExt(file.name.split('.').pop()); // console.log(file);\n\n    const reader = new window.FileReader();\n    console.log(\"reader\");\n    reader.readAsArrayBuffer(file);\n    console.log();\n\n    reader.onloadend = () => {\n      setBuffer(Buffer(reader.result));\n      console.log(reader.result);\n    };\n\n    console.log(\"final\");\n  };\n\n  const handleKeyChange = e => {\n    setPublicKey(e.target.value);\n  };\n\n  const handlePKeyChange = e => {\n    setPrivateKey(e.target.value);\n  };\n\n  const handleUserName = e => {\n    setUsername(e.target.value);\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setPublicKey(e.target.value);\n    setPrivateKey(e.target.value);\n    console.log(pu);\n\n    try {\n      dispatch({\n        type: 'SET_LOADING',\n        payload: true\n      });\n      const key = new NodeRSA(publicKey);\n      console.log(key);\n      console.log(\"buffer\", buffer);\n      const encrypt = key.encrypt(buffer);\n      console.log(encrypt);\n      let filePath = \"\";\n\n      for await (const result of Ipfs.add(encrypt)) {\n        await state.contract.methods.set(result.path).send({\n          from: state.accounts[0]\n        });\n        console.log(\"final-2\");\n        filePath = result.path;\n        dispatch({\n          type: 'SET_PATH',\n          payload: result.path\n        });\n        dispatch({\n          type: 'SET_NOTIF',\n          payload: {\n            msg: result.path,\n            success: true\n          }\n        });\n      } //ikkada manam post cheyali data ni\n\n\n      console.log(filePath);\n      console.log(privateKey); // Axios.post(\"http://localhost:3001/post\",{\n      //   username:username,\n      //   key:privateKey,\n      //   path: filePath,\n      //  })\n      //  .then((res)=>{\n      //   console.log(res);\n      //   if(res.data==username)\n      //   {\n      //     console.log(\"Data sent\");\n      //   }\n      //   else{\n      //   alert(res.data.message);\n      //   }\n      //  })\n\n      Axios.post(\"http://localhost:3001/post\", {\n        username: username,\n        path: filePath,\n        pkey: privateKey,\n        exxt: ext\n      }).then(res => {\n        console.log(res);\n\n        if (res.data == username) {\n          console.log(\"Data sent\");\n        } else {\n          alert(res.data.message);\n        }\n      });\n    } catch (error) {\n      dispatch({\n        type: 'SET_NOTIF',\n        payload: {\n          msg: error.message,\n          success: false\n        }\n      });\n    } finally {\n      dispatch({\n        type: 'SET_LOADING',\n        payload: false\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"add-document\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, \"SEND\")), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }\n  }, \"File\"), /*#__PURE__*/React.createElement(\"input\", {\n    className: \"u-full-width\",\n    type: \"file\",\n    onChange: handleFileChange,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }, \"Username\"), /*#__PURE__*/React.createElement(\"input\", {\n    className: \"u-full-width\",\n    type: \"text\",\n    onChange: handleUserName,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }\n  }, \"Public Key\"), /*#__PURE__*/React.createElement(\"input\", {\n    className: \"u-full-width\",\n    type: \"text\",\n    value: state.publicKey || '',\n    onChange: handleKeyChange,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 9\n    }\n  }, \"Private Key\"), /*#__PURE__*/React.createElement(\"input\", {\n    className: \"u-full-width\",\n    type: \"text\",\n    value: state.privateKey || '',\n    onChange: handlePKeyChange,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"u-full-width button-primary\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }\n  }, \"submit\")));\n};\n\nexport default AddDocument;","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/DAPP-master-dup/DAPP-master/client/src/components/AddDocument.js"],"names":["React","useState","useContext","Ipfs","NodeRSA","Context","useNavigate","Axios","AddDocument","navigate","state","dispatch","buffer","setBuffer","publicKey","setPublicKey","privateKey","setPrivateKey","username","setUsername","ext","setExt","handleFileChange","e","file","target","files","name","split","pop","reader","window","FileReader","console","log","readAsArrayBuffer","onloadend","Buffer","result","handleKeyChange","value","handlePKeyChange","handleUserName","handleSubmit","preventDefault","pu","type","payload","key","encrypt","filePath","add","contract","methods","set","path","send","from","accounts","msg","success","post","pkey","exxt","then","res","data","alert","message","error"],"mappings":"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","sourcesContent":["import React, {useState, useContext} from 'react';\nimport Ipfs from './Ipfs';\nimport NodeRSA from 'node-rsa';\nimport Context from '../store/Context';\nimport { useNavigate } from 'react-router-dom';\nimport Axios from 'axios';\nconst AddDocument = () => {\n  const navigate=useNavigate()\n  const {state, dispatch} = useContext(Context);\n\n  const [buffer, setBuffer] = useState();\n  const [publicKey, setPublicKey] = useState();\n  const [privateKey,setPrivateKey]=useState();\n  const [username,setUsername]=useState();\n  const [ext,setExt]=useState(\"\");\n  const handleFileChange = e => {\n    const file = e.target.files[0];\n    // console.log(file);\n    setExt(file.name.split('.').pop())\n    // console.log(file);\n    const reader = new window.FileReader();\n    console.log(\"reader\");\n    reader.readAsArrayBuffer(file);\n    console.log();\n    \n    reader.onloadend = () => {\n      setBuffer(Buffer(reader.result));\n      console.log(reader.result);\n    }\n\n    console.log(\"final\");\n  }\n\n  const handleKeyChange = e => {\n    setPublicKey(e.target.value);\n  }\n\n  const handlePKeyChange = e => {\n    setPrivateKey(e.target.value);\n  }\n\n  const handleUserName = e =>{\n    setUsername(e.target.value);\n  }\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setPublicKey(e.target.value);\n    setPrivateKey(e.target.value);\n    console.log(pu)\n    try {\n      dispatch({type: 'SET_LOADING', payload: true});\n      const key = new NodeRSA(publicKey);\n      console.log(key);\n      console.log(\"buffer\",buffer);\n      const encrypt = key.encrypt(buffer);\n      console.log(encrypt)\n      let filePath=\"\";\n      for await (const result of Ipfs.add(encrypt)) {\n        await state.contract.methods\n          .set(result.path)\n          .send({from: state.accounts[0]});\n        console.log(\"final-2\");\n        filePath = result.path;\n        dispatch({type: 'SET_PATH', payload: result.path});\n        dispatch({\n          type: 'SET_NOTIF',\n          payload: {msg: result.path, success: true}\n        });\n      }\n      //ikkada manam post cheyali data ni\n      console.log(filePath);\n      console.log(privateKey)\n      // Axios.post(\"http://localhost:3001/post\",{\n      //   username:username,\n      //   key:privateKey,\n      //   path: filePath,\n      //  })\n      //  .then((res)=>{\n      //   console.log(res);\n      //   if(res.data==username)\n      //   {\n      //     console.log(\"Data sent\");\n      //   }\n      //   else{\n      //   alert(res.data.message);\n      //   }\n      //  })\n      Axios.post(\"http://localhost:3001/post\",{\n  username: username,\n  \n  path: filePath,\n  pkey: privateKey,\n  exxt:ext,\n})\n.then((res)=>{\n  console.log(res);\n  if(res.data==username) {\n    console.log(\"Data sent\");\n  } else {\n    alert(res.data.message);\n  }\n});\n    } catch (error) {\n      dispatch({\n        type: 'SET_NOTIF',\n        payload: {msg: error.message, success: false}\n      });\n    } finally {\n      dispatch({type: 'SET_LOADING', payload: false});\n    }\n  }\n\n  \n  return (\n    <div className='add-document'>\n    <h2><b>SEND</b></h2>\n    <form onSubmit={handleSubmit}>\n      <label>File</label>\n      <input\n        className='u-full-width'\n        type='file'\n        onChange={handleFileChange}\n        required />\n        <label>Username</label>\n      <input\n        className='u-full-width'\n        type='text'\n        onChange={handleUserName}\n        required />\n      <label>Public Key</label>\n      <input\n        className='u-full-width'\n        type='text'\n        value={state.publicKey || ''}\n        onChange={handleKeyChange}\n        required />\n        <label>Private Key</label>\n      <input\n        className='u-full-width'\n        type='text'\n        value={state.privateKey || ''}\n        onChange={handlePKeyChange}\n        required />\n      <button\n        className='u-full-width button-primary'\n        type='submit'>\n        submit\n      </button>\n      \n    </form>\n    </div>\n  )\n}\n\nexport default AddDocument;\n\n\n"]},"metadata":{},"sourceType":"module"}